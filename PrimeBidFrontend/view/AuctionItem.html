<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fill Details</title>
    <link rel="stylesheet" href="css/AuctionItem.css">
</head>
<body>
    <div class="container">
        <div class="form-header">
            <button class="back-button">&larr;</button>
            <h1>Fill Details</h1>
        </div>
        <form id="auction-item-form">
            <div class="form-group">
                <label for="product-name">Product Name</label>
                <input type="text" id="product-name" placeholder="iPhone 11" required>
            </div>

            <div class="form-group">
                <label for="category">Auction Category</label>
                <input type="text" id="category" placeholder="Electronic" required>
            </div>

            <div class="form-group">
                <label for="item-description">Item Description</label>
                <textarea id="item-description" placeholder="Vintage 1950s leather jacket in excellent condition. Features classic design with brass zippers and comfortable fit" required></textarea>
            </div>

            <div class="form-group">
                <label for="starting-bid">Starting Bid</label>
                <input type="number" id="starting-bid" placeholder="100" required>
            </div>

            <div class="form-group">
                <label for="auction-duration">Auction Duration</label>
                <input type="number" id="auction-duration" placeholder="7" required>
            </div>

            <div class="form-group">
                <label for="additional-terms">Additional Terms and Conditions</label>
                <textarea id="additional-terms" placeholder="Enter any additional terms..."></textarea>
            </div>

            <div class="form-buttons">
                <button type="button" class="preview-button">Cancel</button>
                <button type="submit" class="post-button">Next</button>
            </div>
        </form>
    </div>

    <script>
        document.getElementById('auction-item-form').addEventListener('submit', async function (event) {
            event.preventDefault(); // Prevent form from submitting the traditional way
            
            const data = {
                productName: document.getElementById('product-name').value,
                category: document.getElementById('category').value,
                description: document.getElementById('item-description').value,
                startingBid: parseFloat(document.getElementById('starting-bid').value),
                duration: parseInt(document.getElementById('auction-duration').value),
                terms: document.getElementById('additional-terms').value
            };

            try {
                const response = await fetch("http://localhost:5115/api/AuctionItem", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(data)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    console.error("Error:", errorData);
                    alert("Failed to submit auction item. Check the console for details.");
                } else {
                    const responseData = await response.json();
                    console.log("Success:", responseData);
                    alert("Auction item created successfully!");
                    // Optionally, you can clear the form or redirect the user here
                }
            } catch (error) {
                console.error("Error:", error);
                alert("An error occurred. Check the console for details.");
            }
        });
    </script>
</body>
</html>
